## 序列神经网络

### 基本介绍

例如你想要建立一个能够自动识别句中人们位置的序列模型

x: "Harry Potter and Hermione Granger invented a new spell."

现在给定这样的输入数据x，希望得到一个序列模型输出y，使得输入的每个单词都对应一个输出值。:jack_o_lantern:这个输出值是能够表明输入的单词是否是属于人名的一部分。

> X     :memo:Harry Potter and Hermione Granger invented a new spell. 序列数据
>             X<1>    X<2>							  		  X<9>
>
> Y           1		1       0 	    1 		1		0	0	0	0
> 	    Y<1>    Y<2>							  		  Y<9>

如何表示一个句子里的单个词汇：one-hot

首先是提出一张词表，你要列出你的表示方法中要用到的单词，如下列词表

![image-20240911205535980](https://cdn.jsdelivr.net/gh/JIaDLu/BlogImg/img/202409112055055.png)

当选定了10000词的词典之后，让这个词典去遍历你的训练集，然后使用one-hot来表示x中的每个单词。

![image-20240911205655675](https://cdn.jsdelivr.net/gh/JIaDLu/BlogImg/img/202409112056702.png)

那么可以使用X<t>来指代句子里的任意词，他就是一个one-hot向量（只有一个值为1，其余值为0）。回到上述的例子，那个句子会有9个one-hot向量来表示句中的9个单词。

:goal_net:这样做的目的：**使序列模型在X和Y之间学习建立一个映射**

### 循环神经网络

先从简单的神经网络看看是否能很好地训练：

![image-20240911211321291](https://cdn.jsdelivr.net/gh/JIaDLu/BlogImg/img/202409112113339.png)

问题：

1. 庞大的输入层
2. 对于不同句子会有不同长度，不是所有的句子都有相同输入长度（输出长度也不一样）
3. 不共享从文本的不同位置上学到的特征

:cyclone:循环神经网络 

> [!IMPORTANT]
>
> 循环神经网络使从左往右扫描数据，同时每个时间步的参数都是共享的。同一个网络在多个不同时间点被使用了多次。

![image-20240911212857876](https://cdn.jsdelivr.net/gh/JIaDLu/BlogImg/img/202409112128902.png)

一般开始先输入a<0>, 它是一个零向量，接着进行前向传播：

![image-20240911213622376](/Users/jiadong/Library/Application Support/typora-user-images/image-20240911213622376.png)

### 词汇表征

 word representation

上面介绍了用one-hot去构建计算机能理解的词表征。这种表示方法的一大缺点就是：**它把每个词都孤立起来，对相关词的泛化能力不强。**

:diamond_shape_with_a_dot_inside:例如你已经学到了一个语言模型，当你看到:  I want a glass of orange ____ .那么这个划线的的词____会是什么，很可能是juice。算法如果学到了那么就会这样填。但如果看到：I want a glass of apple ____ 因为算法不知道 苹果和橙子的关系，所以算法很难从orange juice这一东西去理解 apple juice很常见的

> 根本原因是：任何两个one-hot向量的内积都是0，这些向量之间的距离都一样，所以无法知道apple和orange 要比 man和orange 相似得多。

:key:引入 ： word embedding 词嵌入

我们不再用one-hot去单纯地表示词，而是用特征化的形式去表示每个词：

![image-20240911215112222](https://cdn.jsdelivr.net/gh/JIaDLu/BlogImg/img/202409112151262.png)

那么这样，我们就组成了一个30维的向量来表示'man',‘woman’ ... 这些词。

情况一：现在，我们用这种方式来表示橙子、苹果这些词，那么橙子、苹果的这种表示方法下肯定会非常相似。可能会有特征不太一样，例如颜色、口味... 但总的来说，橙子和苹果的大部分特征实际上都是一样的。**因此，对于知道橙子果汁的算法，大概率很会明白苹果果汁这个东西（橙子果汁是一个训练样本，模型已经见过的了；而苹果果汁是测试样本，是一个完全新的数据）**

情况二：训练集中：Sally Johnson is an orange farmer. 那么在测试集中会出现这样一种例子：Robbert Lin is a durian cultivator. 我们深知对于 **命名实体识别任务**只有一个很小标记的训练集，这个训练集甚至都没有durian(榴莲)，cultivator(培育家)这些词。但是如果你用了词嵌入，<u>它会告诉模型榴莲是水果；培育家跟农民差不多</u>，那么就有可能从你的训练集中的an orange farmer 归纳出榴莲培育家也是一个人，那么Robbert Lin应该也得是个人名（而不能是公司名或者其他）。

#### 使用迁移学习

把从互联网上获取的词嵌入模型（这个模型是在大量的无标签文本中学习到的），然后把它迁移到你的任务中。

1. 自己操作：从大量的文本集中学习词嵌入模型（或者一般选择从网上下载预训练好的词嵌入模型）
2. 用这个词嵌入模型把它迁移到你的新的任务中。把词输入到这个词嵌入中，它就会给你返回一组特征向量

#### 嵌入矩阵

当你应用算法来学习自己的词嵌入矩阵时，实际上是学习一个嵌入矩阵。假设我们的词典有10000个，我们要去学习一个嵌入矩阵E。那么E的shape为(300, 10000)。矩阵的各列代表的是10000个不同的单词

![image-20240911222339125](https://cdn.jsdelivr.net/gh/JIaDLu/BlogImg/img/202409112223172.png)

**使用嵌入矩阵乘以one-hot向量就会得到嵌入向量**。假设字典中的第6738的单词为orange：

![image-20240911223016546](https://cdn.jsdelivr.net/gh/JIaDLu/BlogImg/img/202409112230571.png)

我们的目标是如何学习一个嵌入矩阵E！

#### 如何学习词嵌入：略

### LSTM





### Self-attention







